# ASR Hunting Queries

Clicking on the name of the query will bring you to the file for it in this git repo.

***Or try them out right away in your M365 Security tenant:***

Click on the 'ðŸ”Ž' hotlink to plug the query right into your Advanced Hunting Query page

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA7VY227bRhDd5wL9B8FAAQmwYlE3Sin84MBp6wJp3cRpHoqiWN4sJbKkmJJdB_34njkzFEmbSu22AWFquTu7O5ezZ2Z95I5cy124mZu7HK2PbutSd-3u0L51nn1bt3YJ2huMJPjOML5yV2jN0LfBaO6eY50jd4lVNujdusg9czGljtyJ-4Sea8yutrvuDd5LyM_xTt0CoxuOiNwV995QlyP3A-YUkpfuG9d3PfeLaTrHO4fMK7RiapbjL4O0yg3c2I2sfQrZjLsmtvI5Z8g-MddfYUxlU3dj-snqL92fsHOBcbHwe-ztMTOBPTl-T6lDTG3Wu3Vy-OAOcleY97X7Cu8UY63PzrmAfETJljvGn_pd_7S_7V5jd2k1r_Ccfrs2Xx1ijUJetJ5jxbpEh7r9xveBe0EbY_cB82THLWRFF_FoC62qFxQNN1x9SX-WuueQuGRvQitktxvK5NjlEH8jxMW7Cd4D_E6Bh4kL0SvIGLoAXyO0pvj16O9i5QmePnQbYzzCaAzZEVd7qLtoKjHdVjzXIiKX1HzJSJRITom4OeREakFUqYwnWuQ0pFinkFIbIvRN8fbQK6ENI1iT4ltsiNEX064hNe1SNiDC5RkSmSNgrdmGn6FfRlSn1GNN38u3r2CsakXM8-N3J0V6ZtRXLFhTLiZqcr7VigSaZNBtCE3EV122AmvJiRErPJ7EWgm0zmBpTO3HjIz_glY8Jppqy4DICKnTmBHxtCGmLSPESZE2Ii8oqnpEWEj5FN9TPP-XLWLB-x27FDFZkX90dIOvFjloxvOxP04hz4xYFiM6GbQPzV5FWwZLxKII-g_QGnDfjCclgmyMR7DYbNuPsOEGf28qjCJ6iUa_QrLeX1q4wBxhZ0WaWphg7BZtWd3T1uRJUUyou3B3iN_AbJFYiaVD2tElawTkBon4FLENiWLx0xR-Sh7BDRqzgt_Wlgs013jMWTATrrB3Ri6MK3mwyr0lq0XUNLRM08VbmMEb_kZE3YTnK0Grb5w3IrJi9A8Zp2bN39HDA8ySLHLuzug_1bOOuzpShbU0N6qW4ithrhAynv7t06bM_Bva2UjwjMlb0uqhZ8iW8ECIr6dwb0YeSu_peU3sLHfI2RI1ivyWnYk7WpBa9vR2QlKidcFoiZWHHLu0luJ2w_XzXcQWrHI2xjFzqy_mxl0HjIrYL9wgrS45PGRLegeMY0SGSM1ryvI9-kMi2K_lpLeWP-UU3DCXxKbLuqHyUAs8vaF6XnNOTm_dsuZITdeYCIqIKWVt2TswpI15dpQNBoyrxLlP_E3Q6jGmg735Uzk4qZ2FlnnS048arzKSGqsCo8oAOX2-Moy26IuY9Z_4_o72bjlzVenLWT_maOt-snqbCPfExTNDWGeH5hRWxeT5ghcFtz16IoTVGT3hzTsedk95PsfG-VJP9Pd4os7G9exU8L1qf0nLq3mr9M45-POlnYuypniHqvXMOPCKp1T6y7wcULcpc69WEpkxyBD6TozvtQLpEpWC0DExGzKLj_dyiVbU9fNR6LWlXdUK7mFO0oh7Q-mW6C3tfQt7X-yqpL6hUBhdWG9MLTVvZTw5yuYxMRvwN-XIkP0Rs_hjcnLhyS05pZqXv0wFJcjUvDlnJizZThkoImt5eiulp4uqW33TJ9NM4RmtO8R6QW6fvtF6ROIeMVN0mVsCcrGnn1Krc5p9c8JzGFGj17QrsRrjv9aMkiFCnhvPqqpruVprRs-4akw1v0jsM_tSiz1r-X1nTm8Kc8Pm0qIriBN9ttBzVjk_5V2tZI_79yLVO-XpiHg-tCYfMO_1dzVUYGdqxDM1Zi6YsrIQtgw4q8x8v7tv-XtKHRSFLys3Rxn7i7cHre5SRqVk_Auw3Nqlxq3C7zLr1u7RLeyjt8WD3UrCfeqTpOFup7dGqSkXZGDZs83v6p2vjT09PZyiOs2pSZtoSbiz6iac_R1vQguyUgfMW-x3hp6O3R0fanUG6RNI6mqqU7njH0_cs75asaMis6itW7UI_MRbd9p4-z28J3tmfc27vOddV9jjg-U1tSbjqgticWNnqs1ZLXsed8uvzmiy6nHxvS_VqVnerIPs3GHuWjbsU9gvp0kzk8z-RKS-Yjaa2f9tcmZ8QWvpveoJKP6PEdNXWk1k0PlhDOoROMYTmCX7diw549_teD_qsmfP9jxhfKvrHnMdWalcuQ1p1VTm9Piuj3aYBe7-MR5NWD1-0BNUIrMiWxSrP81Hn_NqcxybffI3bnXgc0AUAAA&timeRangeId=month) [ASR Summary](ASRSummary.kusto)
- Lists each ASR rule with its GUID
- Counts number of endpoints with audit hits for each rule
- Counts number of endpoints with blocks for each rule
- Counts total number of events for each rule

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA72WXUvrQBCG51o4_0G8Fgp67UWpCoIfxc_rmKRNNbUhm1oPHPztPvMm7bGlgmAiS5LZ-XpnZ3dm07Oe7drcXiy2mU0ZKXQFb8Y35ZvbpKEi8SOeCt5UvAo915kxnlc6GfLKAtRCVCYftW2wAssYzognhhPLKrUxPkr7a39sx46Zv0qe2glUHVWQrMf4J98Z_FJx9NH0qDzqW3wU4h7ZO-89pAG9viXIH5Fc80TM3Hqg6HJmQ2YzIQZGn6wkij7lu_cj5BN705rnaEZEkGtVU2hHHsi2atbYNe4VeR81me0O-Zx3pDwOZJU0GBO4OVbubdQy5hUrHOEvrE5UYjfQJXZF61ifs9j9CdrcNa_UPprFr6NfkNtYSA-q6kM7UCQTIvG9zTvEXl_hGVZPOt9LH23iDqUd0ApNhTiun1yPYU63ysjAFHm7qAFuXbW199_Y32t27gXKz9UC2i3b9P-5Crf1pGOsF9j7PeJ9uU3sO_WdUn2h9rctgm4R76AeO9y_e3zluqXL1YpusBmLl5Bfz_6r5O3gLm8OX1EuvMRORScNSrxa6b285OrJX9ep4xfyt6zp3bW_gEvs_Z9jH_6pKmKT9x99KKxMfO8Sk-bmqdSxxhs7sc3bd6y2461rLXu111fCrVj_S30ApogSEnYJAAA&timeRangeId=week) [ASR Single Rule Audit Hits](ASRSingleRuleAudits.kusto)
- Attack Surface Reduction (ASR) rules in Audit mode generate events that would be blocks in Block mode
- View ASR audit hits to build your exceptions before putting rules in block mode
- Query shows individual process information for all audit hits in a single rule

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA5VQQQrCMBCcs-AfcquC4As8iNqjeBDvtQ200BoxqUXx8c6uNBXRgywh2dnZ2dmsYXFFhZz3hi-LEwI8xhjhAYMOJbELj8GSrECuI2ePG86KemIZGdLVsRrYYZCQ7YkmqjRnmBiO-L9qK-UFVhxqhkWBVN-F-hM12cEzDqpaU6fXf7no52dEip8OrFY_d2mJSS5zk_g7nnjDEMcV7tovTlv1arDgyWM-wZT5kZO-z54RT4nJdltqNhEb9tzpVuWbA6e_1esO05_taNCO2gEAAA&timeRangeId=week) [ASR Top Files Audited](ASRTopFiles.kusto)
- Top files triggering ASR rules, sorted by number of audit hits
- Each file is displayed with which rule it is triggering

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA5VRywrCMBCcs-A_5FY99Qs8iI8vEO-xDVaoRppUUfx4JyNtUfQgS9nd2cnsozlyGER4nOkLWMYOe-YNDowC0SujiIqRRYtSmWGefMAYIyzJvDAv6FeMHE597SGFiljDz2BOViTXk7PBjX0TGohZMtKroV9GdiCaScn0lqb7V2khXmTFo6Y5brJWXGq2pFZo44CtVGtd46X_PoElUv6cwKn6uUd3udQ36y8TiB9pVve-632atNWsBjP9lS6fYMp8x07few-qXhfouIPiE2X_VBHwAQAA&timeRangeId=month) [ASR Top Rules Audited](ASRTopRules.kusto)
- Top ASR rules being triggered, sorted by number of audit hits

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA5WSUUvDMBSFz7Pgfwi-1IJ_YQ_iVPRBhfku3RZndW1H2zkm_ni_3KzrkBWUEJKce8_JuTcZy-tTuWas1-y8SrVqdKoTfctpozewmul0SVZLbkXOs7ZaGdqAZWQE1oZoC8MpIbsBTUzJ7UYGcz6o5C36W2UNFs6eNdn7asALRrg515fxr9Bbm3-nEXO2P58r1YVlZKa0IBJ4Hp2YG5Q-OL-AeGMc85iSOWXvND7o2wPcgjXc8Ej2k_Wr0IT4HPWg1HuJaFfHO3gO7nQHGrsfqt1yLvVK1JmDY8qdxgq0Qsmb42FvNzhYMjpsZG9Xk5dZxbdw4g84ZJ3ZDLsJ_JpojMWO3nPzlP4Ez8sdo3-HoZ53zsPLNlZx-U_vf7u75RRrDDcsqPGYm_TgV1X2k7tX7tV-AAq0JUYoAwAA&timeRangeId=week) [ASR Top Users Audited](ASRTopUsers.kusto)
- Top users triggering ASR rules, sorted by number of audit hits
- Each user is displayed with which rule(s) they are triggering, their job title, and device name
