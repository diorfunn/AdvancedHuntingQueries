# ASR Hunting Queries

Clicking on the name of the query will bring you to the file for it in this git repo.

***Or try them out right away in your M365 Security tenant:***

Click on the 'ðŸ”Ž' hotlink to plug the query right into your Advanced Hunting Query page

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?queryId=32340&query=H4sIAAAAAAAAA7VY227bRhDd5wL9B8FAAQmwYlE3Sin84MBp6wJp3cRpHoqiWN4sJbKkmpJdB_34njkzFEmbMuy2gSBquTu7O5ezZ2Z15I5cy124mZu7HK0_3dal7trdoX3rPPu2bu0StDcYSfCeYXzlrtCaoW-D0dy9xDpH7hKrbNC7dZF74WJKHbkT9xk915hdbXfdOzyXkJ_jmboFRjccEbkr7r2hLkfuB8wpJC_dN67veu4X03SOZw6ZN2jF1CzHN4O0yg3c2I2sfQrZjLsmtvI5Z8g-MddfYUxlU3dj-snqr91fsHOBcbHwe-ztMTOBPTl-T6lDTG3Wu3Vy-OAOcleY97X7Cs8UY61H51xAPqJkyx3jq37Xr_a33VvsLq3mFV7Sb9fmq0OsUciL1nOsWJfoULff-Dxwr2hj7D5hnuy4hazoIh5toVX1gqLhhqsv6c9S9xwSl-xNaIXsdkOZHLsc4jtCXLyb4DnA7xR4mLgQvYKMoQvwNkJril-P_i5WnuDTh25jjEcYjSE74moPdRdNJabbiudaROSSmi8ZiRLJKRE3h5xILYgqlfFEi5yGFOsUUmpDhL4pnh56JbRhBGtSvIsNMfpi2jWkpl3KBkS4fIZE5ghYa7bhZ-iXEdUp9VjT9_LuKxirWhHz_PjdSZGeGfUVC9aUi4manE-1IoEmGXQbQhPxVZetwFpyYsQKj09irQRaZ7A0pvZjRsZ_QSueEk21ZUBkhNRpzIh42hDTlhHipEgbkRcUVT0iLKR8ivcpPv-XLWLBxx27FDFZkX90dIO3FjloxvOxP04hz4xYFiM6GbQPzV5FWwZLxKII-g_QGnDfjCclgmyMj2Cx2bYfYcMNvu8qjCJ6iUa_QrLeX1q4wBxhZ0WaWphg7BZtWd3T1uRZUUyou3B3iN_AbJFYiaVD2tElawTkBon4FLENiWLx0xR-Sp7ADRqzgt_Wlgs013jMWTATrrB3Ri6MK3mwyr0lq0XUNLRM08VTmMEb_kZE3YTnK0Grb5w3IrJi9A8Zp2bNP9DDA8ySLHLuzug_1bOOuzpShbU0N6qW4ithrhAynv7t06bM_Bva2UjwGZO3pNVDz5At4YEQb8_h3ow8lN7T85rYWe6QsyVqFPktOxN3tCC17OnthKRE64LREisPOXZpLcXthuvnu4gtWOVsjGPmVl_MjbsOGBWxX7hBWl1yeMiW9A4Yx4gMkZrXlOV79IdEsF_LSe8tf8opuGEuiU2XdUPloRZ4ekP1vOacnN66Zc2Rmq4xERQRU8rasndgSBvz7CgbDBhXiXOf-Jug1WNMB3vzp3JwUjsLLfOkpx81XmUkNVYFRpUBcvp8ZRht0Rcx6z_x_R3t3XLmqtKXs37M0db9ZPU2Ee6JixeGsM4OzSmsisnzBS8Kbnv0RAirM3rCm3c87J7yfI6N86We6O_xRJ2N69mp4HvV_pKWV_NW6Z1z8OdrOxdlTfEBVeuZceAVT6n0l3k5oG5T5l6tJDJjkCH0nRjfawXSJSoFoWNiNmQWH-_lEq2o6-ej0GtLu6oV3MOcpBH3htIt0Vva-x72vtpVSX1DoTC6sN6YWmreynhylM1jYjbgb8qRIfsjZvGn5OTCk1tySjUvf5kKSpCpeXPOTFiynTJQRNby9FZKTxdVt_qmT6aZwjNad4j1gtw-faP1iMQ9YqboMrcE5GJPP6VW5zT75oTnMKJGb2lXYjXGf60ZJUOEPDeeVVXXcrXWjJ5x1ZhqfpHYZ_amFnvW8vvOnN4U5obNpUVXECf6bKHnrHJ-yrtayR7370Wqd8rTEfF8aE0-YN7r72qowM7UiGdqzFwwZWUhbBlwVpn5fnff8veUOigKX1dujjL2N28PWt2ljErJ-BdgubVLjVuF32XWrd2jW9hHb4sHu5WE-9QnScPdTm-NUlMuyMCyZ5vv1TtfG3t6ejhFdZpTkzbRknBn1U04-zvehBZkpQ6Yt9jvDD0duzs-1OoM0ieQ1NVUp3LHP565Z321YkdFZlFbt2oR-Im37rTx9nt4T_bM-pp3-ci7rrDHJ8tras2C_LQhFjd2ptpPvtk36f-0SN6X6tRsbN65wwy1bNijsFLOjOYfmfmZOr5hzpnZvzM587pgsvRRFefFvxUxPaI1QwZ9H3q67udjfAKzYt-OJTP8ux3vx1b27NmeJ6ydq-seV1Zs03cRq5LHfdyEtNK7K57rYqXn2fmYZ5pj0WzXPx_c-KbqEwAA&timeRangeId=month) [ASR Summary](ASRSummary.kusto)
- Lists each ASR rule with its GUID
- Counts number of endpoints with audit hits for each rule
- Counts number of endpoints with blocks for each rule
- Counts total number of events for each rule

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA72WXUvrQBCG51o4_0G8Fgp67UWpCoIfxc_rmKRNNbUhm1oPHPztPvMm7bGlgmAiS5LZ-XpnZ3dm07Oe7drcXiy2mU0ZKXQFb8Y35ZvbpKEi8SOeCt5UvAo915kxnlc6GfLKAtRCVCYftW2wAssYzognhhPLKrUxPkr7a39sx46Zv0qe2glUHVWQrMf4J98Z_FJx9NH0qDzqW3wU4h7ZO-89pAG9viXIH5Fc80TM3Hqg6HJmQ2YzIQZGn6wkij7lu_cj5BN705rnaEZEkGtVU2hHHsi2atbYNe4VeR81me0O-Zx3pDwOZJU0GBO4OVbubdQy5hUrHOEvrE5UYjfQJXZF61ifs9j9CdrcNa_UPprFr6NfkNtYSA-q6kM7UCQTIvG9zTvEXl_hGVZPOt9LH23iDqUd0ApNhTiun1yPYU63ysjAFHm7qAFuXbW199_Y32t27gXKz9UC2i3b9P-5Crf1pGOsF9j7PeJ9uU3sO_WdUn2h9rctgm4R76AeO9y_e3zluqXL1YpusBmLl5Bfz_6r5O3gLm8OX1EuvMRORScNSrxa6b285OrJX9ep4xfyt6zp3bW_gEvs_Z9jH_6pKmKT9x99KKxMfO8Sk-bmqdSxxhs7sc3bd6y2461rLXu111fCrVj_S30ApogSEnYJAAA&timeRangeId=week) [ASR Single Rule Audit Hits](ASRSingleRuleAudits.kusto)
- Attack Surface Reduction (ASR) rules in Audit mode generate events that would be blocks in Block mode
- View ASR audit hits to build your exceptions before putting rules in block mode
- Query shows individual process information for all audit hits in a single rule

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA5VQQQrCMBCcs-AfcquC4As8iNqjeBDvtQ200BoxqUXx8c6uNBXRgywh2dnZ2dmsYXFFhZz3hi-LEwI8xhjhAYMOJbELj8GSrECuI2ePG86KemIZGdLVsRrYYZCQ7YkmqjRnmBiO-L9qK-UFVhxqhkWBVN-F-hM12cEzDqpaU6fXf7no52dEip8OrFY_d2mJSS5zk_g7nnjDEMcV7tovTlv1arDgyWM-wZT5kZO-z54RT4nJdltqNhEb9tzpVuWbA6e_1esO05_taNCO2gEAAA&timeRangeId=week) [ASR Top Files Audited](ASRTopFiles.kusto)
- Top files triggering ASR rules, sorted by number of audit hits
- Each file is displayed with which rule it is triggering

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA5VRywrCMBCcs-A_5FY99Qs8iI8vEO-xDVaoRppUUfx4JyNtUfQgS9nd2cnsozlyGER4nOkLWMYOe-YNDowC0SujiIqRRYtSmWGefMAYIyzJvDAv6FeMHE597SGFiljDz2BOViTXk7PBjX0TGohZMtKroV9GdiCaScn0lqb7V2khXmTFo6Y5brJWXGq2pFZo44CtVGtd46X_PoElUv6cwKn6uUd3udQ36y8TiB9pVve-632atNWsBjP9lS6fYMp8x07few-qXhfouIPiE2X_VBHwAQAA&timeRangeId=month) [ASR Top Rules Audited](ASRTopRules.kusto)
- Top ASR rules being triggered, sorted by number of audit hits

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA5WSUUvDMBSFz7Pgfwi-1IJ_YQ_iVPRBhfku3RZndW1H2zkm_ni_3KzrkBWUEJKce8_JuTcZy-tTuWas1-y8SrVqdKoTfctpozewmul0SVZLbkXOs7ZaGdqAZWQE1oZoC8MpIbsBTUzJ7UYGcz6o5C36W2UNFs6eNdn7asALRrg515fxr9Bbm3-nEXO2P58r1YVlZKa0IBJ4Hp2YG5Q-OL-AeGMc85iSOWXvND7o2wPcgjXc8Ej2k_Wr0IT4HPWg1HuJaFfHO3gO7nQHGrsfqt1yLvVK1JmDY8qdxgq0Qsmb42FvNzhYMjpsZG9Xk5dZxbdw4g84ZJ3ZDLsJ_JpojMWO3nPzlP4Ez8sdo3-HoZ53zsPLNlZx-U_vf7u75RRrDDcsqPGYm_TgV1X2k7tX7tV-AAq0JUYoAwAA&timeRangeId=week) [ASR Top Users Audited](ASRTopUsers.kusto)
- Top users triggering ASR rules, sorted by number of audit hits
- Each user is displayed with which rule(s) they are triggering, their job title, and device name
